# Telegram客服机器人

一个简洁的Telegram客服机器人，提供便捷的支付指导服务。只在私聊中工作，支持支付宝和微信支付指导，包含二维码展示和口令红包功能。

## 功能特性

- ✅ **支付指导服务**：提供支付宝和微信支付指导
- ✅ **二维码展示**：支持发送支付二维码图片
- ✅ **口令红包**：提供支付宝口令红包代码
- ✅ **私聊专用**：只在私聊中响应，不干扰群组消息
- ✅ **申请状态查询**：用户可随时查看支付申请状态
- ✅ **SQLite数据库**：本地数据存储，安全可靠
- ✅ **简洁界面**：直观的用户界面

### 💰 支付服务

#### 支付宝支付
- 📱 **扫码支付**：展示支付宝二维码图片
- 🧧 **口令红包**：提供口令代码供用户领取
- 💬 **详细指导**：步骤清晰的支付说明

#### 微信支付
- 📱 **扫码支付**：展示微信二维码图片
- 💬 **详细指导**：步骤清晰的支付说明

#### 客服服务
- 📞 **微信联系**：提供店主微信号（xymh0923）
- 💬 **在线咨询**：随时联系客服获取帮助

## 环境要求

- Python 3.8+
- pip
- Telegram Bot Token（从 @BotFather 获取）
- 支付宝和微信二维码图片文件

## 安装步骤

1. 克隆或下载项目文件

2. 安装依赖：
```bash
pip install -r requirements.txt
```

3. 准备支付二维码图片：
   - 将支付宝二维码保存为 `alipay_qr.png`
   - 将微信二维码保存为 `wechat_qr.png`
   - 将图片文件放在项目根目录

4. 配置环境变量：
```bash
cp env_example .env
# 编辑 .env 文件，填写实际配置信息
```

5. 配置主要参数：
```bash
# 必须配置的项目
TELEGRAM_BOT_TOKEN=your_bot_token_here       # 从 @BotFather 获取

# 支付配置
ALIPAY_QR_CODE=alipay_qr.png                 # 支付宝二维码图片路径
WECHAT_QR_CODE=wechat_qr.png                 # 微信二维码图片路径
ALIPAY_RED_ENVELOPE_CODE=你的口令代码         # 支付宝口令红包代码

# 客服配置
CUSTOMER_SERVICE_WECHAT=xymh0923             # 店主微信号
```

## 数据库初始化

项目使用SQLite数据库，首次运行时会自动创建必要的表结构：
- users: 用户信息表（包含申请状态）

## 运行机器人

### 运行客服机器人
```bash
python main.py
```

系统会启动Telegram客服机器人，只在私聊中响应消息。

## Telegram Bot 配置

1. 创建机器人：
   - 在Telegram中找到 @BotFather
   - 发送 `/newbot` 创建新机器人
   - 获取Bot Token

3. 准备支付材料：
   - 支付宝二维码图片 (`alipay_qr.png`)
   - 微信二维码图片 (`wechat_qr.png`)
   - 支付宝口令红包代码

## Telegram Bot 配置

1. 创建机器人：
   - 在Telegram中找到 @BotFather
   - 发送 `/newbot` 创建新机器人
   - 获取Bot Token

## 使用说明

### 用户操作

1. 用户在Telegram中私聊机器人
2. 发送 `/start` 开始使用
3. 选择支付方式：
   - 💚 **支付宝** - 显示支付宝二维码图片
   - 💙 **微信** - 显示微信二维码图片
   - 🧧 **口令红包** - 显示支付宝口令红包创建指导

### 支付功能

#### 支付宝支付
- 点击"💚 支付宝"按钮直接显示二维码图片
- 用户可以使用支付宝扫码完成支付

#### 微信支付
- 点击"💙 微信"按钮直接显示二维码图片
- 用户可以使用微信扫码完成支付

#### 口令红包
- 点击"🧧 口令红包"按钮显示创建指导
- 包含详细的支付宝口令红包创建步骤
- 提供口令文字示例和注意事项

### 界面特点

- ⚡ **一键直达** - 点击按钮直接显示对应内容
- 🔄 **返回功能** - 每个页面都有返回按钮
- 📱 **图片展示** - 支持发送二维码图片
- 📝 **文字指导** - 详细的操作说明
- 📊 **状态查询** - 用户可随时查看申请状态

## 使用流程

1. 用户在Telegram中私聊机器人
2. 发送 `/start` 开始申请
3. 选择支付方式并完成支付
4. 系统自动记录申请状态
5. 用户可发送 `/status` 查看申请状态

## 安全注意事项

- 🔐 妥善保管Bot Token
- 📝 定期备份数据库文件
- 🖼️ 确保支付二维码图片文件存在且正确

## 故障排除

### 常见问题

1. **机器人无响应**
   - 检查Bot Token是否正确
   - 确认机器人未被封禁
   - 检查网络连接

2. **权限管理问题**
   - 检查管理员权限设置
   - 确认超级管理员ID配置正确
   - 查看权限操作日志

3. **图片无法发送**
   - 检查二维码图片文件是否存在
   - 确认图片格式正确（PNG格式推荐）
   - 确保文件路径配置正确

### 日志查看

系统会输出详细的日志信息，帮助诊断问题。

## 技术实现

### 核心技术栈

- **Python 3.8+** - 主要编程语言
- **python-telegram-bot** - Telegram机器人框架
- **SQLite** - 本地数据库存储
- **asyncio** - 异步任务处理

### 数据库设计

- **users** - 用户信息和申请状态

## 部署建议

### 生产环境部署

1. 使用反向代理（如Nginx）
2. 配置SSL证书
3. 设置进程管理（如systemd）
4. 配置日志轮转
5. 设置监控告警

### 云服务器推荐

- 支持Python 3.8+
- 稳定的网络连接
- 足够的内存和存储

## 更新日志

### v2.0.0 - 权限管理系统重构
- 🚀 完全重构为权限管理系统
- ❌ 移除所有支付相关功能
- ✅ 添加多级管理员权限系统
- 👁️ 实现实时群组监控功能
- 📝 添加完整的操作日志记录
- 🔧 重写管理员命令系统
- 🎯 优化用户界面和体验

### v1.0.0 - 支付机器人
- 初始版本发布
- 支持支付宝、微信、USDT支付
- 完整的用户管理和群组功能

## 许可证

MIT License

## 贡献

欢迎提交Issue和Pull Request！

## 联系方式

如有问题，请通过以下方式联系：

- Telegram: @your_bot_username
- Email: your-email@example.com

---

**注意：** 这是一个完整的支付系统实现，请在合法合规的前提下使用。作者不对使用过程中产生的任何问题负责。
# beijingPaymentBot
